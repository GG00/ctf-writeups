# Misc 100 - Press it
``````
Description: Recover the flag

Attachment: misc100.zip
``````

In the attachment there is a text file `pressit.txt`, which include 33 lines of hex encoded strings, without any obvious pattern.

```
0x9c
0x36 0x14 0xb6 0x94
0x23 0x17 0xa3 0x1f 0x97 0x39 0x9f 0x17 0xb9 0x1f 0x97 0x9f
0x39
0xb9 0x17
0x97 0x14 0x94
0x36
0x34 0xb6 0x39 0xb4 0xb9
0x36 0x12 0x92
0x25
0xa5
0x18
0x98 0xb6
0xe0 0x38 0x28
0xe0 0xb8 0xa8
0x17 0x97 0x30 0xb0 0x32 0xb2
0x36 0x35
0xb5 0xb6
0x32
0x18 0xb2 0x98
0x20 0xa0
0x12 0x26 0x92 0xa6
0x36 0x35 0xb6 0xb5
0x32 0xb2
0xe0 0x38
0xe0 0x38 0xe0 0x38 0xe0 0x38 0xe0 0x38 0xe0 0x38 0xe0 0x38 0xe0 0x38 0xe0 0x38 0xe0 0x38
0xe0 0x38 0xe0 0x38 0xe0 0x38 0xe0 0x38 0xe0 0x38 0xe0 0x38 0xe0 0x38 0xe0 0x38 0x2b 0xab
0xe0 0xb8
0x39 0xb9
0x39 0xb9
0x36
0x36 0xb6
0x1c 0x9c
0x1d
```

It is also not printable:

```
$ cat pressit.txt | sed -E 's/ ?0x//g' | xxd -r -p | xxd
0000000: 9c36 14b6 9423 17a3 1f97 399f 17b9 1f97  .6...#....9.....
0000010: 9f39 b917 9714 9436 34b6 39b4 b936 1292  .9.....64.9..6..
0000020: 25a5 1898 b6e0 3828 e0b8 a817 9730 b032  %.....8(.....0.2
0000030: b236 35b5 b632 18b2 9820 a012 2692 a636  .65..2... ..&..6
0000040: 35b6 b532 b2e0 38e0 38e0 38e0 38e0 38e0  5..2..8.8.8.8.8.
0000050: 38e0 38e0 38e0 38e0 38e0 38e0 38e0 38e0  8.8.8.8.8.8.8.8.
0000060: 38e0 38e0 38e0 38e0 382b abe0 b839 b939  8.8.8.8.8+...9.9
0000070: b936 36b6 1c9c 1d                        .66....
```

After studying on it a little bit, and with the name of the challange (pressit) as a hint, I figured out that it is a IBM PC keyboard scancode dump.

(0x12, 0x25, 0x18 (on line 9,10,12) are codes for "E", "K", "O" respectly)

With the help of [this table](http://stanislavs.org/helppc/make_codes.html),
I was able to convert the raw scancode to keyboard actions, and after inputing it manually to `cat`, it turns out to be:

```
$ cat
This is it> EKO^['ibm?model?m^[\
```

Which stills doesn't fit the flag format.

There are two keyboard actions which don't seems to make sense to me: `RightAlt+'` and `RightAlt+\`.

It reminds me that the CTF (EKOparty) is hosted in Argentina, where they use Spanish keyboard layout.


Then I started a Ubuntu LiveCD VM with Spanish kb layout, and `cat` the actions.

![menu](https://i.imgur.com/NX2fMlK.png)
![truth1](http://i.imgur.com/px4nX17.png)

Flag: EKO{ibm_model_m}
