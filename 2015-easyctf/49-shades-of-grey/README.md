# 49 Shades of Grey (Forensics 125)

Description:
```
We only have 49 shades of gray D:

#000000 to #F5F5F5... there's one shade missing! Find the hex value of the missing shade. Pound sign optional.

Image

Hint: How can we tell which color is which?
```

![shades](http://i.imgur.com/ZNRYzaR.png)

According to the desc, we'll need to analyze the colors in the image.<br>
I'll use PIL for that.

```python
>>> from PIL import Image
>>> i = Image.open('shades.png')
>>> i
<PIL.PngImagePlugin.PngImageFile image mode=RGB size=512x512 at 0x7FCC98CECB38>
>>> c = i.getcolors()
>>> c
[(5321, (245, 245, 245)), (5381, (235, 235, 235)), (5413, (225, 225, 225)), (5346, (215, 215, 215)), (5401, (205, 205, 205)), (5347, (195, 195, 195)), (5326, (185, 185, 185)), (5375, (175, 175, 175)), (5342, (165, 165, 165)), (5454, (155, 155, 155)), (5354, (145, 145, 145)), (5418, (135, 135, 135)), (5280, (125, 125, 125)), (5401, (115, 115, 115)), (5389, (105, 105, 105)), (5396, (95, 95, 95)), (5406, (85, 85, 85)), (5408, (75, 75, 75)), (5306, (65, 65, 65)), (5269, (55, 55, 55)), (5318, (45, 45, 45)), (5316, (35, 35, 35)), (5266, (25, 25, 25)), (5438, (15, 15, 15)), (5425, (5, 5, 5)), (5368, (240, 240, 240)), (5320, (230, 230, 230)), (5259, (220, 220, 220)), (5223, (210, 210, 210)), (5354, (200, 200, 200)), (5472, (190, 190, 190)), (5374, (180, 180, 180)), (5375, (170, 170, 170)), (5226, (160, 160, 160)), (5210, (150, 150, 150)), (5390, (140, 140, 140)), (5310, (130, 130, 130)), (5317, (120, 120, 120)), (5421, (110, 110, 110)), (5321, (100, 100, 100)), (5421, (90, 90, 90)), (5362, (70, 70, 70)), (5366, (60, 60, 60)), (5301, (50, 50, 50)), (5263, (40, 40, 40)), (5284, (30, 30, 30)), (5286, (20, 20, 20)), (5405, (10, 10, 10)), (5420, (0, 0, 0))]
```

Let's convert the colors into int and sort it, for our convenience.

```python
>>> l = [int(3 * "%.2x" % tuple(int(n) for n in i[1]), 16) for i in c]
>>> l.sort()
>>> l
[0, 328965, 657930, 986895, 1315860, 1644825, 1973790, 2302755, 2631720, 2960685, 3289650, 3618615, 3947580, 4276545, 4605510, 4934475, 5592405, 5921370, 6250335, 6579300, 6908265, 7237230, 7566195, 7895160, 8224125, 8553090, 8882055, 9211020, 9539985, 9868950, 10197915, 10526880, 10855845, 11184810, 11513775, 11842740, 12171705, 12500670, 12829635, 13158600, 13487565, 13816530, 14145495, 14474460, 14803425, 15132390, 15461355, 15790320, 16119285]
```

Now, we'll need to get the differences between each values.

```python
>>> [x[0]-x[1] for x in zip(l[1:],l[:-1])]
[328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 657930, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965, 328965]
```

Noticed that there's a `657930` inside?

```python
>>> [x[0]-x[1] for x in zip(l[1:],l[:-1])].index(657930)
15
>>> l[16] - l[15]
657930
```

So the answer must be `l[15] + 328965`.

```python
>>> l[15] + 328965
5263440
>>> hex(l[15] + 328965)
'0x505050'
```

Flag: `easyctf{505050}`
